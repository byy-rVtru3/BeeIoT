# Сброс пароля

# Сброс пароля

## Описание
Эндпоинт для восстановления пароля пользователя. Процесс состоит из трех этапов:
1. Запрос кода восстановления на email
2. Проверка кода восстановления (используется универсальный эндпоинт [confirm](./confirm.md))
3. Установка нового пароля

## 1. Запрос кода восстановления

### HTTP запрос
```
POST /api/auth/password-reset/request
```

### Тело запроса
```json
{
  "email": "user@example.com"
}
```

#### Параметры
- `email` (string, обязательный) - Email адрес пользователя

### Ответы

#### 200 OK
Код восстановления отправлен на почту.
```json
{
  "code": 200,
  "message": "Код восстановления пароля отправлен на указанную почту"
}
```

#### 404 Not Found
Пользователь с таким email не найден.
```json
{
  "code": 404,
  "message": "Пользователь с таким email не найден"
}
```

#### 429 Too Many Requests
Слишком много запросов на восстановление.
```json
{
  "code": 429,
  "message": "Слишком много запросов. Попробуйте позже",
  "retry_after": 900
}
```

## 2. Проверка кода восстановления

Используйте универсальный эндпоинт [подтверждения кода](./confirm.md) с параметром `type: "password_reset"`.

## 3. Установка нового пароля

### HTTP запрос
```
POST /api/auth/password-reset/update
```

### Тело запроса
```json
{
  "email": "user@example.com",
  "new_password": "new_secure_password"
}
```

#### Параметры
- `email` (string, обязательный) - Email адрес пользователя
- `new_password` (string, обязательный) - Новый пароль

### Ответы

#### 200 OK
Пароль успешно изменен.
```json
{
  "code": 200,
  "message": "Пароль успешно изменен"
}
```

#### 401 Unauthorized
Код не был предварительно подтвержден.
```json
{
  "code": 401,
  "message": "Сначала необходимо подтвердить код восстановления"
}
```

#### 404 Not Found
Пользователь не найден.
```json
{
  "code": 404,
  "message": "Пользователь не найден"
}
```

## Дополнительная информация

### Безопасность
- Код восстановления действителен в течение 15 минут
- Максимум 3 попытки ввода неверного кода
- После использования код становится недействительным

### Ограничения
- Не более 3 запросов на восстановление пароля в час на один email

## Связанные эндпоинты
- [Авторизация](./login.md) - вход в систему с новым паролем
- [Регистрация](./registration.md) - создание нового аккаунта
- [Подтверждение регистрации](./confirm.md) - активация аккаунта